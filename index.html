<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PureShare (HTML/JS)</title>
    <!-- Tailwind CSS Yüklemesi -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Animasyonlu yükleyici için stil */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #fbbd23;
            border-radius: 50%;
            width: 1.5rem;
            height: 1.5rem;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-zinc-950 text-zinc-100 min-h-screen">
    
    <!-- Yükleniyor Ekranı -->
    <div id="loading-screen" class="min-h-screen bg-zinc-950 flex items-center justify-center text-white">
        <div class="animate-pulse flex flex-col items-center">
            <!-- Zap Icon (Yıldırım) -->
            <svg class="h-12 w-12 text-yellow-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
            <p>PureShare Yükleniyor...</p>
        </div>
    </div>
    
    <!-- Ana Uygulama İçeriği (JS yüklendikten sonra gösterilir) -->
    <div id="app-container" class="hidden">
        
        <!-- Header -->
        <header id="header-content" class="border-b border-zinc-800 bg-zinc-900/50 backdrop-blur-md sticky top-0 z-50">
            <!-- JS tarafından doldurulacak -->
        </header>

        <main class="max-w-7xl mx-auto px-4 py-8">
            
            <!-- Paylaşım Bölümü -->
            <section id="share-section" class="mb-12">
                <!-- JS tarafından doldurulacak (Form) -->
            </section>

            <!-- Genel Akış Bölümü -->
            <section>
                <div id="feed-header">
                    <!-- JS tarafından doldurulacak (Başlık) -->
                </div>
                <div id="media-feed" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Medya öğeleri buraya JS ile yüklenecek -->
                </div>
            </section>
        </main>

        <!-- Silme Modalı -->
        <div id="delete-modal" class="hidden fixed inset-0 bg-black bg-opacity-70 z-[100] flex items-center justify-center p-4">
            <!-- JS tarafından doldurulacak -->
        </div>

        <!-- Footer -->
        <footer class="mt-20 border-t border-zinc-800 pt-8 text-center text-zinc-600 text-sm pb-8">
            <p>PureShare Lossless Platform &copy; 2024</p>
            <p class="mt-2 text-xs max-w-md mx-auto">
                Not: Bu platform, dosyaları sunucu tarafında yeniden kodlamaz. Yalnızca URL linkleri üzerinden paylaşım yapılır. 
                **Otomatik Özetler, Google'ın Gemini API'si ile oluşturulmuştur.**
            </p>
        </footer>
    </div>
    
    <!-- Firebase ve Uygulama Mantığı (Module Script) -->
    <script type="module">
        // Firebase SDK Modül İçe Aktarımları
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, serverTimestamp, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // --- Inline SVG İkonları (React'teki Lucide yerine) ---
        // Link Ikonu
        const LinkIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 text-yellow-500"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>`;
        // Zap Icon (Akışa Gönder)
        const ZapIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" class="h-5 w-5 fill-black"><path d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>`;
        // İndirme Ikonu
        const DownloadIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" x2="12" y1="15" y2="3"></line></svg>`;
        // Oynat Ikonu
        const PlayIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>`;
        // Silme Ikonu
        const TrashIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>`;
        // Yükleniyor/Yenileme Ikonu (Gemini için)
        const RefreshIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 animate-spin"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path><path d="M3 21v-5h5"></path></svg>`;

        // --- Global Durum ve Sabitler ---
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(__firebase_config);
        
        let app, auth, db, currentUser = null;
        let mediaItems = [];
        let itemToDelete = null;

        const API_KEY = ""; 
        const GEMINI_MODEL = "gemini-2.5-flash-preview-09-2025";
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent?key=${API_KEY}`;


        // --- DOM Element Referansları (Globalde tutulanlar) ---
        const loadingScreen = document.getElementById('loading-screen');
        const appContainer = document.getElementById('app-container');
        let headerUserId, shareForm, mediaFeed, deleteModal, deleteConfirmButton, deleteCancelButton; // submitButton handleShare içinde doğrudan çekilecek

        // --- Helper Function: Tekrarlı Fetch (Exponential Backoff) ---
        const fetchWithRetry = async (url, options, retries = 3) => {
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(url, options);
                    if (response.status === 429 && i < retries - 1) {
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        continue;
                    }
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response;
                } catch (error) {
                    if (i === retries - 1) throw error;
                }
            }
        };

        // --- Gemini API Çağrısı: Özet Oluşturma ---
        const generateSummary = async (title, url) => {
            const systemPrompt = "Act as a helpful content curator. Given a video title and URL, generate a concise, single-paragraph summary (max 3 sentences) that describes the content. Use the Google Search tool to gather context about the title or URL if necessary.";
            const userQuery = `Analyze the following media content and provide a summary (Turkish or English based on the content): Title: "${title}". URL: "${url}".`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                tools: [{ "google_search": {} }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            try {
                const response = await fetchWithRetry(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                
                return text || "Özet oluşturulamadı.";
            } catch (error) {
                console.error("Gemini API Hata:", error);
                return "Özet oluşturma servisi geçici olarak kullanılamıyor.";
            }
        };


        // --- UI Görüntüleme Fonksiyonları ---

        const renderFeed = () => {
            if (!mediaFeed) return;
            mediaFeed.innerHTML = ''; // Mevcut öğeleri temizle

            if (mediaItems.length === 0) {
                mediaFeed.innerHTML = `
                    <div class="md:col-span-3 text-center py-20 bg-zinc-900/50 rounded-2xl border border-zinc-800 border-dashed">
                        <p class="text-zinc-500">Henüz hiç yüksek kaliteli medya paylaşılmadı. İlk sen ol!</p>
                    </div>
                `;
                return;
            }

            mediaItems.forEach(item => {
                const isUploader = currentUser && currentUser.uid === item.uploaderId;
                
                let previewContent;
                if (item.type === 'video') {
                    previewContent = `
                        <div class="w-full h-full relative group-hover:scale-105 transition-transform duration-500">
                            <!-- Video etiketi, autoplay'i tetiklemek için JS onmouseover kullanır -->
                            <video 
                              src="${item.url}" 
                              class="w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"
                              controls="false"
                              muted
                              loop
                              onmouseover="this.play().catch(() => {});"
                              onmouseout="this.pause()"
                              poster="https://placehold.co/600x400/000000/FFF?text=Video+Loading"
                            ></video>
                            <div class="absolute top-3 right-3 bg-black/70 backdrop-blur text-white text-xs font-bold px-2 py-1 rounded border border-white/10 flex items-center gap-1">
                                <!-- FileVideo Icon -->
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-3 w-3"><path d="M22 17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10z"></path><line x1="12" x2="12" y1="12" y2="12"></line></svg>
                                ${item.quality}
                            </div>
                            <a 
                                href="${item.url}"
                                target="_blank" 
                                rel="noopener noreferrer"
                                class="absolute inset-0 bg-black/50 flex items-center justify-center text-xs text-zinc-300 opacity-0 group-hover:opacity-100 transition-opacity"
                            >
                                İzlemek için oynatıcıya tıklayın
                            </a>
                        </div>
                    `;
                } else if (item.type === 'image') {
                    previewContent = `
                        <div class="w-full h-full relative group-hover:scale-105 transition-transform duration-500">
                            <img 
                              src="${item.url}" 
                              alt="${item.title}" 
                              class="w-full h-full object-cover opacity-90 group-hover:opacity-100 transition-opacity"
                              onerror="this.onerror=null; this.src='https://placehold.co/600x400/000000/FFF?text=Fotoğraf+Yüklenemedi';"
                            />
                            <div class="absolute top-3 right-3 bg-black/70 backdrop-blur text-white text-xs font-bold px-2 py-1 rounded border border-white/10 flex items-center gap-1">
                                <!-- ImageIcon Icon -->
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-3 w-3"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"></rect><circle cx="9" cy="9" r="2"></circle><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path></svg>
                                ${item.quality}
                            </div>
                        </div>
                    `;
                } else {
                    previewContent = `
                       <div class="text-center p-8 text-zinc-500">
                          <!-- ExternalLink Icon -->
                          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-8 w-8 mx-auto mb-2"><path d="M15 22.5L12 19.5M12 19.5L9 22.5M12 19.5V2.5"></path></svg>
                          Doğrudan URL Linki
                       </div>
                    `;
                }
                
                const summaryClass = item.summary === "Özet oluşturuluyor..." ? 'text-yellow-500 animate-pulse' : 'text-zinc-300';

                const html = `
                    <div class="bg-zinc-900 border border-zinc-800 rounded-xl overflow-hidden hover:border-zinc-700 transition-all hover:shadow-2xl group flex flex-col">
                        
                        <!-- Önizleme Alanı -->
                        <div class="relative aspect-video bg-black flex items-center justify-center overflow-hidden">
                            ${previewContent}
                        </div>

                        <!-- Bilgi Alanı -->
                        <div class="p-5 flex-1 flex flex-col justify-between">
                            <div>
                                <h3 class="font-bold text-lg text-white mb-1 truncate">${item.title}</h3>
                                <div class="flex items-center gap-3 text-xs text-zinc-500 mb-3">
                                    <span>${item.type.toUpperCase()}</span>
                                    <span class="w-1 h-1 rounded-full bg-zinc-700"></span>
                                    <span>${item.quality || 'Kalite Bilinmiyor'}</span>
                                    <span class="w-1 h-1 rounded-full bg-zinc-700"></span>
                                    <span>Yükleyen: ${item.uploaderId?.slice(0,4) || 'Anonim'}...</span>
                                </div>
                                
                                <!-- GEMINI ÖZETİ -->
                                <p class="text-sm mt-3 ${summaryClass}">
                                    <strong class="text-zinc-400">Özet: </strong>
                                    ${item.summary || "Özet oluşturulmadı."}
                                </p>
                            </div>

                            <div class="flex gap-2 mt-4">
                                <!-- Orijinal İndir Butonu: download attribute'ü ve target="_blank" olmadan -->
                                <a 
                                    href="${item.url}" 
                                    rel="noopener noreferrer"
                                    class="flex-1 bg-white text-black hover:bg-zinc-200 font-semibold py-2 px-4 rounded-lg text-sm flex items-center justify-center gap-2 transition-colors"
                                    download="${item.title ? item.title.replace(/[^a-z0-9]/gi, '_') : 'media_file'}.${item.type === 'image' ? 'jpg' : 'mp4'}"
                                >
                                    ${DownloadIcon}
                                    Orijinal İndir
                                </a>
                                
                                <!-- Aç/Oynat Butonu: Yeni sekmede açar (target="_blank" ile) -->
                                <a 
                                    href="${item.url}" 
                                    target="_blank" 
                                    rel="noopener noreferrer"
                                    class="flex-1 bg-zinc-800 text-zinc-300 hover:bg-zinc-700 font-semibold py-2 px-4 rounded-lg text-sm flex items-center justify-center gap-2 transition-colors"
                                >
                                    ${PlayIcon}
                                    Aç/Oynat
                                </a>
                                ${isUploader ? `
                                    <button 
                                        data-id="${item.id}"
                                        class="delete-btn bg-zinc-800 hover:bg-red-900/50 text-zinc-400 hover:text-red-400 p-2 rounded-lg transition-colors"
                                        title="Sil"
                                    >
                                        ${TrashIcon}
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
                mediaFeed.insertAdjacentHTML('beforeend', html);
            });
        };


        // --- Firebase ve Uygulama Mantığı ---

        const initApp = () => {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);

            // 1. Yetkilendirme (Authentication)
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    currentUser = user;
                    // Başlıkta kullanıcı ID'sini göster
                    const initials = user.uid.slice(0, 2).toUpperCase();
                    if (headerUserId) headerUserId.textContent = initials;
                    
                    // Uygulamayı göster, yükleniyor ekranını gizle
                    loadingScreen.classList.add('hidden');
                    appContainer.classList.remove('hidden');

                    // 2. Veri dinlemeyi başlat
                    startDataListener();
                } else {
                    // Özel jeton ile veya anonim olarak giriş yapmayı dene
                    try {
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await signInWithCustomToken(auth, __initial_auth_token);
                        } else {
                            await signInAnonymously(auth);
                        }
                    } catch (error) {
                        console.error("Yetkilendirme Hatası:", error);
                    }
                }
            });
        };


        const startDataListener = () => {
            const mediaCollectionRef = collection(db, 'artifacts', appId, 'public', 'data', 'shared_media');
            const q = query(mediaCollectionRef);

            onSnapshot(q, (snapshot) => {
                mediaItems = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                // Oluşturulma zamanına göre sırala (en yeni en başta)
                mediaItems.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));
                renderFeed();
            }, (error) => {
                console.error("Veri çekme hatası:", error);
                renderFeed(); // Hata olsa bile mevcut veriyi göster
            });
        };

        const handleShare = async (e) => {
            e.preventDefault();
            
            // Hata düzeltme: Elemanları doğrudan fonksiyonda çek
            const titleInput = document.getElementById('title-input');
            const urlInput = document.getElementById('url-input');
            const typeInput = document.getElementById('type-input');
            const qualityInput = document.getElementById('quality-input');
            const submitButton = document.getElementById('submit-button'); // Hata buradan kaynaklanıyordu

            const title = titleInput.value;
            const mediaUrl = urlInput.value;
            const mediaType = typeInput.value;
            const qualityLabel = qualityInput.value;

            if (!mediaUrl || !title || !currentUser) {
                console.error("Lütfen bir URL ve başlık girin.");
                return;
            }

            // Paylaşım durumunu ayarla
            if(submitButton) {
                submitButton.disabled = true;
                submitButton.innerHTML = `${RefreshIcon} Özet Oluşturuluyor...`;
            }

            try {
                // 1. İlk belgeyi kaydet ve referansı al
                const docRef = await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'shared_media'), {
                    title,
                    url: mediaUrl,
                    type: mediaType,
                    quality: qualityLabel,
                    summary: "Özet oluşturuluyor...", // Başlangıç durumu
                    uploaderId: currentUser.uid,
                    createdAt: serverTimestamp(),
                    authorName: "Anonim Kullanıcı" 
                });

                // Formu temizle
                titleInput.value = '';
                urlInput.value = '';
                qualityInput.value = 'Orijinal 4K/RAW';

                // 2. Gemini API'yi kullanarak özeti oluştur (arka planda çalışır)
                const generatedSummaryText = await generateSummary(title, mediaUrl);
                
                // 3. Belgeyi oluşturulan özetle güncelle
                await updateDoc(docRef, {
                    summary: generatedSummaryText
                });

            } catch (error) {
                console.error("Paylaşım veya Özet Oluşturma Hatası:", error);
            } finally {
                // Paylaşım durumunu sıfırla
                if(submitButton) {
                    submitButton.disabled = false;
                    submitButton.innerHTML = `${ZapIcon} Akışa Gönder (Gemini Destekli)`;
                }
            }
        };

        const openDeleteModal = (id) => {
            itemToDelete = id;
            deleteModal.classList.remove('hidden');
        };

        const closeDeleteModal = () => {
            itemToDelete = null;
            deleteModal.classList.add('hidden');
        };
        
        const confirmDelete = async () => {
            if (!itemToDelete) return;
            closeDeleteModal();

            try {
                await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'shared_media', itemToDelete));
                console.log("Paylaşım başarıyla silindi.");
            } catch (error) {
                console.error("Silme hatası:", error);
            } finally {
                itemToDelete = null;
            }
        };


        // --- DOM Hazır Olduğunda Başlatma ---
        document.addEventListener('DOMContentLoaded', () => {
            
            // DOM Element Referanslarını Ata
            headerUserId = document.getElementById('header-user-id');
            mediaFeed = document.getElementById('media-feed');
            deleteModal = document.getElementById('delete-modal');
            deleteConfirmButton = document.getElementById('delete-confirm-btn');
            deleteCancelButton = document.getElementById('delete-cancel-btn');
            // submitButton artık handleShare içinde çekiliyor, globalden kaldırıldı.

            // --- Statik HTML İçeriğini Doldur ---
            document.getElementById('header-content').innerHTML = `
                <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
                    <div class="flex items-center gap-2">
                        <div class="bg-gradient-to-tr from-yellow-400 to-orange-500 p-2 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 text-black"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path><polyline points="16 6 12 2 8 6"></polyline><line x1="12" x2="12" y1="2" y2="15"></line></svg>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold tracking-tight text-white">PureShare</h1>
                            <p class="text-xs text-zinc-400">Sıfır Sıkıştırma. Sınırsız Boyut.</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-4 text-sm text-zinc-400">
                        <div class="hidden md:flex items-center gap-1">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4 text-green-500"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path><path d="m9 12 2 2 4-4"></path></svg>
                            <span>Lossless Transfer</span>
                        </div>
                        <div id="header-user-id" class="h-8 w-8 rounded-full bg-zinc-800 flex items-center justify-center text-xs font-mono border border-zinc-700">
                            ...
                        </div>
                    </div>
                </div>
            `;
            
            // Paylaşım Formunu Doldur
            document.getElementById('share-section').innerHTML = `
                <div class="bg-zinc-900 border border-zinc-800 rounded-2xl p-6 md:p-8 shadow-2xl relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-32 bg-yellow-500/5 blur-[100px] rounded-full pointer-events-none group-hover:bg-yellow-500/10 transition-all duration-700"></div>
                    
                    <div class="relative z-10">
                        <h2 class="text-2xl font-bold mb-2 flex items-center gap-2">
                            ${LinkIcon}
                            Medya URL'si Paylaş
                        </h2>
                        <p class="text-zinc-400 mb-6 text-sm max-w-2xl">
                            Dosyanın direkt bağlantısını (Google Drive, Dropbox, vb. Direct Link) buraya yapıştırın. 
                            Sistem dosyayı kopyalamaz, sadece linki paylaşır. (Streamable gibi sitelerden doğrudan indirme için lütfen Direct Link formatını kullanın.)
                        </p>

                        <form id="share-form" class="grid grid-cols-1 md:grid-cols-12 gap-4">
                            <!-- Başlık -->
                            <div class="md:col-span-4">
                                <label class="block text-xs font-medium text-zinc-500 mb-1 uppercase tracking-wider">Başlık</label>
                                <input id="title-input" type="text" placeholder="Örn: Doğa Gezisi 4K RAW" class="w-full bg-zinc-950 border border-zinc-800 rounded-lg px-4 py-3 focus:outline-none focus:border-yellow-500/50 focus:ring-1 focus:ring-yellow-500/50 transition-all text-white placeholder:text-zinc-600" required>
                            </div>

                            <!-- URL -->
                            <div class="md:col-span-5">
                                <label class="block text-xs font-medium text-zinc-500 mb-1 uppercase tracking-wider">Medya URL (Direct Link)</label>
                                <input id="url-input" type="url" placeholder="https://your-direct-link.com/video.mp4" class="w-full bg-zinc-950 border border-zinc-800 rounded-lg px-4 py-3 focus:outline-none focus:border-yellow-500/50 focus:ring-1 focus:ring-yellow-500/50 transition-all text-yellow-400 placeholder:text-zinc-600 font-mono text-sm" required>
                            </div>

                            <!-- Tür & Kalite -->
                            <div class="md:col-span-3 flex gap-2">
                                <div class="flex-1">
                                    <label class="block text-xs font-medium text-zinc-500 mb-1 uppercase tracking-wider">Tür</label>
                                    <select id="type-input" class="w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-3 focus:outline-none text-zinc-300">
                                        <option value="video">Video</option>
                                        <option value="image">Fotoğraf</option>
                                        <option value="diğer">Diğer</option>
                                    </select>
                                </div>
                                <div class="flex-1">
                                    <label class="block text-xs font-medium text-zinc-500 mb-1 uppercase tracking-wider">Kalite/Boyut</label>
                                    <input id="quality-input" type="text" value="Orijinal 4K/RAW" placeholder="4K RAW / 5GB" class="w-full bg-zinc-950 border border-zinc-800 rounded-lg px-3 py-3 focus:outline-none text-zinc-300">
                                </div>
                            </div>

                            <div class="md:col-span-12 flex justify-end mt-2">
                                <button id="submit-button" type="submit" class="bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-3 px-8 rounded-lg transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                                    ${ZapIcon} Akışa Gönder (Gemini Destekli)
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            `;

            // Silme Modalını Doldur
            document.getElementById('delete-modal').innerHTML = `
                <div class="bg-zinc-900 border border-zinc-700 rounded-xl p-6 w-full max-w-sm shadow-2xl" onclick="event.stopPropagation()">
                    <h3 class="text-xl font-bold mb-3 text-white">Paylaşımı Sil</h3>
                    <p class="text-zinc-400 mb-6 text-sm">
                        Bu paylaşımı silmek istediğinizden emin misiniz? Bu işlem geri alınamaz.
                    </p>
                    <div class="flex justify-end gap-3">
                        <button id="delete-cancel-btn" class="px-4 py-2 bg-zinc-700 text-white rounded-lg hover:bg-zinc-600 transition-colors">
                            İptal
                        </button>
                        <button id="delete-confirm-btn" class="px-4 py-2 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 transition-colors">
                            Silmeyi Onayla
                        </button>
                    </div>
                </div>
            `;
            
            // Akış Başlığını Doldur
            document.getElementById('feed-header').innerHTML = `
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 text-zinc-400"><path d="M16 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v10z"></path><line x1="12" x2="12" y1="12" y2="12"></line><path d="m18 15 4-2-4-2"></path><path d="M6 12h.01"></path></svg>
                        Paylaşılan Akış
                    </h2>
                    <span class="text-xs bg-zinc-800 text-zinc-400 px-3 py-1 rounded-full border border-zinc-700">
                        Canlı Veri
                    </span>
                </div>
            `;

            // Event Listener Atamaları
            shareForm = document.getElementById('share-form');
            shareForm.addEventListener('submit', handleShare);
            
            mediaFeed.addEventListener('click', (e) => {
                const deleteButton = e.target.closest('.delete-btn');
                if (deleteButton) {
                    openDeleteModal(deleteButton.dataset.id);
                }
            });

            deleteModal.addEventListener('click', closeDeleteModal); // Modal dışına tıklayınca kapat
            if(deleteConfirmButton) deleteConfirmButton.addEventListener('click', confirmDelete);
            if(deleteCancelButton) deleteCancelButton.addEventListener('click', closeDeleteModal);
            
            // Uygulamayı Başlat
            initApp();
        });
    </script>
</body>
</html>
